"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["4758"],{80150:function(e,s,n){n.r(s);var r=n(85893),l=n(50065);function i(e){let s=Object.assign({h1:"h1",a:"a",p:"p",code:"code",h2:"h2",ul:"ul",li:"li",div:"div",pre:"pre",span:"span",table:"table",thead:"thead",tr:"tr",th:"th",strong:"strong",tbody:"tbody",td:"td"},(0,l.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"simple-development",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#simple-development",children:"#"}),"Simple Development"]}),"\n",(0,r.jsxs)(s.p,{children:["In this chapter, we will introduce the basic usage workflow of D-Robotics-LLM to help you get started quickly. Here, we use the ",(0,r.jsx)(s.code,{children:"InternLM2-1.8B"})," model as an example for demonstration."]}),"\n",(0,r.jsxs)(s.h2,{id:"model-and-deployment-package-preparation",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#model-and-deployment-package-preparation",children:"#"}),"Model and Deployment Package Preparation"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Download the provided D-Robotics_LLM_","{version}",".tar.gz deployment package and extract it."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Download the provided ",(0,r.jsx)(s.code,{children:"InternLM2_1.8B_1024.hbm"})," model."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive info",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"Note"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:["For the download link of the hbm model, please refer to the ",(0,r.jsx)(s.code,{children:"resolve_model.txt"})," file located in the ",(0,r.jsx)(s.code,{children:"model"})," folder of ",(0,r.jsx)(s.code,{children:"oellm_runtime"}),"."]})})]}),"\n",(0,r.jsx)(s.p,{children:"After preparing both the deployment package and the model, integrate the model (*.hbm) with the oellm_runtime SDK from the deployment package. The reference directory structure is as follows:"}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-text",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"llm"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"\u2514\u2500\u2500 D-Robotics_LLM_{version}"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    \u2514\u2500\u2500 oellm_runtime"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u251C\u2500\u2500 model"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u2502   \u251C\u2500\u2500 resolve_model.txt"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u2502   \u2514\u2500\u2500 InternLM2_1.8B_1024.hbm"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u251C\u2500\u2500 config"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u2502   \u2514\u2500\u2500 InternLM2_1.8B_config"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u251C\u2500\u2500 example"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u2502   \u251C\u2500\u2500 oellm_run"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u2502   \u251C\u2500\u2500 oellm_multichat"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u2502   \u2514\u2500\u2500 oellm_ppl"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u251C\u2500\u2500 include"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u251C\u2500\u2500 lib"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        \u2514\u2500\u2500 set_performance_mode.sh"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})})]})})}),"\n",(0,r.jsxs)(s.h2,{id:"on-device-runtime-preparation",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#on-device-runtime-preparation",children:"#"}),"On-Device Runtime Preparation"]}),"\n",(0,r.jsx)(s.p,{children:"Create a working directory on the device using the following commands as reference:"}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Create working directory"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"mkdir"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-p"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"/home/root/llm"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"cd"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"/home/root/llm"})]}),"\n"]})})}),"\n",(0,r.jsx)(s.p,{children:"Copy the integrated folder from your development machine to this on-device directory. Reference command:"}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"scp"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-r"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"llm/*"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"root@{board_ip}:/home/root/llm"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.p,{children:["Finally, under the path ",(0,r.jsx)(s.code,{children:"/home/root/llm/D-Robotics_LLM_{version}/oellm_runtime"}),", configure ",(0,r.jsx)(s.code,{children:"LD_LIBRARY_PATH"}),". Reference commands:"]}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Modify hardware register values to switch the device into performance mode"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"sh"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"set_performance_mode.sh"})]}),"\n",(0,r.jsx)(s.span,{className:"line line-number"}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Set environment variable"})}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"lib"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"/home/root/llm/D-Robotics_LLM_{version}/oellm_runtime/lib"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" LD_LIBRARY_PATH"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"${lib}"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"${LD_LIBRARY_PATH}"})]}),"\n"]})})}),"\n",(0,r.jsxs)(s.h2,{id:"on-device-execution",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#on-device-execution",children:"#"}),"On-Device Execution"]}),"\n",(0,r.jsx)(s.p,{children:"Reference command to run the model on the device:"}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-bash",meta:"",children:[(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"cd"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"./example/oellm_run"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"./oellm_run"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--hbm_path"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"../../model/InternLM2_1.8B_1024.hbm"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--tokenizer_dir"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"../../config/InternLM2_1.8B_config/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" \\"})]}),"\n",(0,r.jsxs)(s.span,{className:"line line-number",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--model_type"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"4"})]}),"\n"]})})}),"\n",(0,r.jsx)(s.p,{children:"The runtime parameters are as follows:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:(0,r.jsx)(s.strong,{children:"Parameter"})}),(0,r.jsx)(s.th,{children:(0,r.jsx)(s.strong,{children:"Description"})}),(0,r.jsx)(s.th,{children:(0,r.jsx)(s.strong,{children:"Optional"})})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"-h, --help"})}),(0,r.jsx)(s.td,{children:"Display help information."}),(0,r.jsx)(s.td,{children:"/"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"--hbm_path"})}),(0,r.jsx)(s.td,{children:"Specifies the path to the quantized model file (*.hbm)."}),(0,r.jsx)(s.td,{children:"Required"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"--tokenizer_dir"})}),(0,r.jsx)(s.td,{children:"Specifies the tokenizer configuration directory."}),(0,r.jsx)(s.td,{children:"Required"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"--model_type"})}),(0,r.jsx)(s.td,{children:"Specifies the model type to run; currently, the InternLM model type is 4."}),(0,r.jsx)(s.td,{children:"Required"})]})]})]}),"\n",(0,r.jsxs)(s.h2,{id:"execution-results",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#execution-results",children:"#"}),"Execution Results"]}),"\n",(0,r.jsx)(s.p,{children:"After successful execution, you can perform a simple conversation test as shown below:"}),"\n",(0,r.jsx)(s.pre,{className:"code",children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-line-number",style:{backgroundColor:"var(--shiki-color-background)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-text",meta:"",children:[(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"[User] <<< How's the weather today?"})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"[Assistant] >>> It's very clear, sunny, and breezy."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"Mom took me for a walk in the park."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'I saw a mother and daughter feeding birds and curiously asked, "Where did these birds come from?"'})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"The woman picked up a long bamboo pole, lifted a small green caterpillar from the ground, then used a long grass stem to place the insect into a nest for feeding."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'When I walked over, my mother kindly said, "Look how cute these little ants are!"'})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"My mom and I went to the big flowerbed and saw some children playing joyfully amid laughter."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'At that moment, an old man was selling watermelons! As soon as he sat down, he looked around and suddenly widened his eyes\u2014he noticed someone approaching with a large bag to buy melons. The old man immediately ran over, pulled out a big watermelon from the bag, handed it to the person, and said, "This is a birthday gift my daughter made for me!"'})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"After returning home, Mom started telling me a story."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"This story taught me an important lesson: No matter where you are, as long as you put in effort, you will reap rewards."})}),"\n",(0,r.jsx)(s.span,{className:"line line-number",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"Performance prefill: 1855.07 tokens/s    decode: 23.83 tokens/s"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})})]})})})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,l.ah)(),e.components);return s?(0,r.jsx)(s,Object.assign({},e,{children:(0,r.jsx)(i,e)})):i(e)}s.default=o,o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["latest%2Fen%2Fguide%2Fquickstart%2FS100P%2Finternlm2%2Fsimple_development_internlm2.mdx"]={toc:[{id:"model-and-deployment-package-preparation",text:"Model and Deployment Package Preparation",depth:2},{id:"on-device-runtime-preparation",text:"On-Device Runtime Preparation",depth:2},{id:"on-device-execution",text:"On-Device Execution",depth:2},{id:"execution-results",text:"Execution Results",depth:2}],title:"Simple Development",frontmatter:{}}}}]);